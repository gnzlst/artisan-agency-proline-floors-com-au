<?php
$menu = [
    [
        'title' => 'Shop Free Samples',
        'items' => [
            [
                'title' => 'Luxury Vinyl Plank',
                'items' => [
                    [
                        'text' => 'Shop All Luxury Vinyl Plank',
                        'url' => '/shop-all-luxury-vinyl-plank/',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'About Luxury Vinyl Plank',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
            [
                'title' => 'Hybrid Flooring',
                'items' => [
                    [
                        'text' => 'Shop All Hybrid Flooring',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'About Hybrid Flooring',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
            [
                'title' => 'Shop by Designer',
                'items' => [
                    [
                        'text' => 'Qlay 2.0',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Qlay 5.0 | 3.0',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Genero Coastal',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Abode Coastal',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Abode Prime',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Rigid Plank',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Rigid Plank XL',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
        ],
    ],
    [
        'title' => 'Shop Stair Nosings and Accesories',
        'items' => [
            [
                'title' => 'Stair Nosings',
                'items' => [
                    [
                        'text' => 'Shop Custom Made Stair Nosing',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Shop Stair Nosing',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
            [
                'title' => 'Accesories',
                'items' => [
                    [
                        'text' => 'Shop Hybrid Flooring Accessories',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Shop Vinyl Cutters',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Shop Maintenance Accessories',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
        ],
    ],
    [
        'title' => 'Designer',
        'items' => [
            [
                'title' => 'Shop by Designer',
                'items' => [
                    [
                        'text' => 'Qlay 2.0',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Qlay 5.0 | 3.0',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Genero Coastal',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Abode Coastal',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Abode Prime',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Rigid Plank',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                    [
                        'text' => 'Rigid Plank XL',
                        'url' => '#',
                        'description' => 'Shop free samples',
                        'description_url' => '#',
                        'extra' => 'Request free measure and quote from one of our stores.',
                        'extra_url' => '#',
                    ],
                ],
            ],
        ],
    ],
    [
        'title' => 'Gallery',
        'url' => '/galleries/',
    ],
];
?>

<header class="banner">
    <nav class="bg-proline-dark border-b-1 border-proline-gray">
        <div class="flex flex-wrap justify-between items-center p-6">
            <a href="{{ home_url('/') }}" class="flex items-center space-x-3 rtl:space-x-reverse">
                <img src="@asset('resources/images/layout/logo-proline-floors-header.png')" class="h-4" alt="{!! $siteName !!} Logo" />
            </a>
            <div
                class="flex flex-col sm:flex-row sm:items-center sm:justify-end sm:space-x-4 space-y-4 sm:space-y-0 pt-4 sm:pt-0">
                <button
                    class="bg-proline-dark border-1 border-proline-gray text-proline-gray px-4 py-2 hover:bg-black uppercase cursor-pointer">
                    See Cart
                </button>
                <button class="bg-proline-gray text-proline-dark px-4 py-2 hover:bg-white uppercase cursor-pointer">
                    Order Free Samples
                </button>
            </div>
        </div>
    </nav>

    @if (has_nav_menu('primary_navigation'))
        <nav class="nav-primary" aria-label="{{ wp_get_nav_menu_name('primary_navigation') }}">
            {!! wp_nav_menu(['theme_location' => 'primary_navigation', 'menu_class' => 'nav', 'echo' => false]) !!}
        </nav>
    @endif

    <nav class="bg-proline-dark">
        <div class="flex flex-wrap items-center justify-between mx-auto p-4">
            <div class="flex md:order-2 space-x-3 rtl:space-x-reverse ml-auto">
                <button class="bg-proline-gray text-proline-dark px-4 py-2 hover:bg-white uppercase cursor-pointer"
                  onclick="location.href='{{ get_permalink(get_page_by_path('where-to-buy')) }}'">
                    Where to Buy
                </button>
                <button
                    class="bg-proline-dark border-1 border-proline-gray text-proline-gray px-4 py-2 hover:bg-black uppercase cursor-pointer"
                    onclick="location.href='{{ get_permalink(get_page_by_path('contact-us')) }}'">
                    Contact Us
                </button>
                <button data-collapse-toggle="mega-menu-full-cta" type="button"
                    class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                    aria-controls="mega-menu-full-cta" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 17 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M1 1h15M1 7h15M1 13h15" />
                    </svg>
                </button>

            </div>
            <div id="mega-menu-full-cta"
                class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1">
                <ul class="flex flex-col mt-4 font-medium md:flex-row md:mt-0 md:space-x-8 rtl:space-x-reverse">
                    @foreach ($menu as $index => $section)
                        <li>
                            @if (isset($section['items']) && is_array($section['items']))
                                <button id="mega-menu-full-cta-dropdown-{{ $index + 1 }}-button"
                                    data-dropdown-target="mega-menu-full-cta-dropdown-{{ $index + 1 }}"
                                    data-dropdown-placement="bottom"
                                    class="flex items-center justify-between w-full py-2 px-3 font-medium text-gray-900 border-b border-gray-100 md:w-auto hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-600 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-blue-500 md:dark:hover:bg-transparent dark:border-gray-700 uppercase cursor-pointer text-left">
                                    {{ $section['title'] }}
                                    <svg class="w-2.5 h-2.5 ms-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                                        fill="none" viewBox="0 0 10 6">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                            stroke-width="2" d="m1 1 4 4 4-4" />
                                    </svg>
                                </button>
                            @else
                                <a href="{{ $section['url'] }}"
                                    class="flex items-center justify-between w-full py-2 px-3 font-medium text-gray-900 border-b border-gray-100 md:w-auto hover:bg-gray-50 md:hover:bg-transparent md:border-0 md:hover:text-blue-600 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-blue-500 md:dark:hover:bg-transparent dark:border-gray-700 uppercase cursor-pointer text-left">
                                    {{ $section['title'] }}
                                </a>
                            @endif
                        </li>
                    @endforeach
                </ul>
            </div>
        </div>

        @foreach ($menu as $index => $section)
            @if (isset($section['items']) && is_array($section['items']))
                <div id="mega-menu-full-cta-dropdown-{{ $index + 1 }}"
                    class="dropdown-menu-item mt-1 bg-proline-dark border-gray-200 shadow-xs border-y hidden">
                    <div
                        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 max-w-screen-2xl px-4 py-5 mx-auto text-sm text-gray-500 dark:text-gray-400 md:px-6">
                        @foreach ($section['items'] as $subsection)
                            <div>
                                <h2 id="title-{{ strtolower(str_replace(' ', '-', $subsection['title'] ?? $section['title'])) }}-{{ $index + 1 }}"
                                    class="mb-8 font-semibold text-gray-900 dark:text-white uppercase">
                                    {{ $subsection['title'] ?? $section['title'] }}
                                </h2>
                                <ul id="menu-{{ strtolower(str_replace(' ', '-', $subsection['title'] ?? $section['title'])) }}-{{ $index + 1 }}"
                                    class="proline-megamenu-list space-y-4 sm:mb-4 md:mb-0 md:columns-2">
                                    @foreach ($subsection['items'] ?? [] as $item)
                                        <li class="mb-6">
                                            <a href="{{ $item['url'] }}"
                                                class="hover:underline hover:text-blue-600 dark:hover:text-blue-500">
                                                {{ ucwords($item['text']) }}
                                            </a>
                                            @if (isset($item['description']))
                                                @if (isset($item['description_url']))
                                                    <a href="{{ $item['description_url'] }}"
                                                        class="block text-proline-persimmon text-xs mt-1 hover:underline">
                                                        {{ $item['description'] }}
                                                    </a>
                                                @else
                                                    <p class="text-proline-persimmon text-xs mt-1">
                                                        {{ $item['description'] }}
                                                    </p>
                                                @endif
                                            @endif
                                            @if (isset($item['extra']))
                                                @if (isset($item['extra_url']))
                                                    <a href="{{ $item['extra_url'] }}"
                                                        class="block text-proline-natural-sienna text-xs mt-1 hover:underline">
                                                        {{ $item['extra'] }}
                                                    </a>
                                                @else
                                                    <p class="text-proline-natural-sienna text-xs mt-1">
                                                        {{ $item['extra'] }}
                                                    </p>
                                                @endif
                                            @endif
                                        </li>
                                    @endforeach
                                </ul>
                            </div>
                        @endforeach
                    </div>
                </div>
            @endif
        @endforeach
    </nav>

</header>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const dropdownButtons = document.querySelectorAll("[data-dropdown-target]");

        function closeAllDropdowns(except = null) {
            document.querySelectorAll(".dropdown-menu-item").forEach(menu => {
                if (menu !== except) {
                    menu.classList.add("hidden");
                }
            });
        }

        dropdownButtons.forEach(button => {
            button.addEventListener("click", (e) => {
                e.stopPropagation();
                const targetId = button.getAttribute("data-dropdown-target");
                const targetMenu = document.getElementById(targetId);
                const isOpen = !targetMenu.classList.contains("hidden");

                closeAllDropdowns(targetMenu);

                if (!isOpen) {
                    targetMenu.classList.remove("hidden");
                } else {
                    targetMenu.classList.add("hidden");
                }
            });
        });

        document.addEventListener("click", () => {
            closeAllDropdowns();
        });
    });
</script>
